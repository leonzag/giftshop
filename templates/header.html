<header class="bg-zinc-900 shadow-md">
    <div class="container flex mx-auto px-4 py-3 items-center justify-between">
        <div class="flex items-center space-x-4">
            <button id="hamburger" class="lg:hidden text-zinc-600 hover:text-cyan-600 focus:outline-none"
                aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é" aria-expanded="false" aria-controls="mobile-menu">
                <i class="fas fa-bars text-2xl"></i>
            </button>

            <a href="{% url 'shop:product_list' %}" class="text-2xl font-bold text-gray-300">MyShop</a>
        </div>

        <nav id="menu" class="hidden lg:flex space-x-6">
            <a href="{% url 'shop:product_list' %}" class="text-gray-300 hover:text-cyan-600 transition duration-300">
                –ì–ª–∞–≤–Ω–∞—è</a>
            <a href="#" class="text-gray-300 hover:text-cyan-600 transition duration-300">–û –Ω–∞—Å</a>
            <a href="#" class="text-gray-300 hover:text-cyan-600 transition duration-300">–£—Å–ª—É–≥–∏</a>
            <a href="#" class="text-gray-300 hover:text-cyan-600 transition duration-300">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
        </nav>

        {# include "searchbar.html" #}

        </div>

        <a href="{% url 'cart:cart_detail' %}" class="relative inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-700 transition">
            üõí –ö–æ—Ä–∑–∏–Ω–∞
            {% if cart and cart|length %}
                <span class="absolute top-0 right-0 -mt-1 -mr-1 px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full">
                    {{ cart|length }}
                </span>
            {% endif %}
        </a>
    </div>

    <div id="mobile-menu" class="lg:hidden hidden bg-zinc-900 border-t border-zinc-600" role="navigation">
        <nav class="mx-auto px-4 py-3 space-y-2">
            <a href="{% url 'shop:product_list' %}" class="block text-gray-300 hover:text-cyan-600 transition duration-300">
                –ì–ª–∞–≤–Ω–∞—è</a>
            <a href="#" class="block text-gray-300 hover:text-cyan-600 transition duration-300">–û –Ω–∞—Å</a>
            <a href="#" class="block text-gray-300 hover:text-cyan-600 transition duration-300">–£—Å–ª—É–≥–∏</a>
            <a href="#" class="block text-gray-300 hover:text-cyan-600 transition duration-300">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
        </nav>
    </div>
</header>

<script>
    const hamburger = document.getElementById('hamburger');
    const mobileMenu = document.getElementById('mobile-menu');

    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ aria-expanded
    hamburger.addEventListener('click', () => {
        const isHidden = mobileMenu.classList.toggle('hidden');
        hamburger.setAttribute('aria-expanded', !isHidden);

        // –ï—Å–ª–∏ –º–µ–Ω—é –æ—Ç–∫—Ä—ã–ª–æ—Å—å, –ø–µ—Ä–µ–Ω–æ—Å–∏–º —Ñ–æ–∫—É—Å –Ω–∞ –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–µ–Ω—é
        if (!isHidden) {
            const firstMenuItem = mobileMenu.querySelector('a');
            if (firstMenuItem) {
                firstMenuItem.focus();
            }
        }
    });

    // Close mobile menu when clicking outside
    document.addEventListener('click', (event) => {
        if (!hamburger.contains(event.target) && !mobileMenu.contains(event.target)) {
            if (!mobileMenu.classList.contains('hidden')) { // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –º–µ–Ω—é –≤–∏–¥–∏–º–æ
                mobileMenu.classList.add('hidden');
                hamburger.setAttribute('aria-expanded', 'false');
            }
        }
    });

    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ —ç–∫—Ä–∞–Ω–∞ –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø
    window.addEventListener('resize', () => {
        if (window.innerWidth >= 1024 && !mobileMenu.classList.contains('hidden')) {
            mobileMenu.classList.add('hidden');
            hamburger.setAttribute('aria-expanded', 'false');
        }
    });

    // –£–ª—É—á—à–µ–Ω–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è (—Ñ–æ–∫—É—Å-–ª–æ–≤—É—à–∫–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é)
    const trapFocus = (element) => {
        const focusableElementsSelector = 'a[href], button, input, select, textarea, [tabindex]:not([tabindex="-1"])';
        const focusable = Array.from(element.querySelectorAll(focusableElementsSelector));

        if (focusable.length === 0) return; // –ù–µ—Ç —Ñ–æ–∫—É—Å–∏—Ä—É–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤

        const firstFocusable = focusable[0];
        const lastFocusable = focusable[focusable.length - 1];

        element.addEventListener('keydown', (e) => {
            const isTabPressed = e.key === 'Tab' || e.keyCode === 9;

            if (!isTabPressed) {
                return;
            }

            if (e.shiftKey) { // Shift + Tab
                if (document.activeElement === firstFocusable) {
                    lastFocusable.focus();
                    e.preventDefault();
                }
            } else { // Tab
                if (document.activeElement === lastFocusable) {
                    firstFocusable.focus();
                    e.preventDefault();
                }
            }
        });
    };

    // –ü—Ä–∏–º–µ–Ω—è–µ–º trapFocus, –∫–æ–≥–¥–∞ –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é –æ—Ç–∫—Ä—ã—Ç–æ
    // –∏ —É–¥–∞–ª—è–µ–º –µ–≥–æ, –∫–æ–≥–¥–∞ –∑–∞–∫—Ä—ã—Ç–æ.
    // –í–º–µ—Å—Ç–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ trapFocus –Ω–∞ –≤—Å–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ,
    // –ø—Ä–∏–º–µ–Ω—è–µ–º –µ–≥–æ —Ç–æ–ª—å–∫–æ –∫ –∞–∫—Ç–∏–≤–Ω–æ–º—É –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É.

    // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã, –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Å–ª—É—à–∞—Ç–µ–ª—å –Ω–∞ mobileMenu,
    // –Ω–æ –≤ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª–µ–µ –¥–∏–Ω–∞–º–∏—á–Ω–æ.
    trapFocus(mobileMenu);

    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ: –µ—Å–ª–∏ –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è, —Ñ–æ–∫—É—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ –≥–∞–º–±—É—Ä–≥–µ—Ä
    mobileMenu.addEventListener('transitionend', () => {
        if (mobileMenu.classList.contains('hidden') && document.activeElement !== hamburger) {
            hamburger.focus();
        }
    });

</script>

<style>
    .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
    }
</style>
