{% extends 'base.html' %}

{% load filters %}

{% block title %}
    {{ product.name }}
{% endblock %}

{% block content %}
    <div class="flex flex-col md:flex-row">
        <div class="md:w-1/2">
            {% if product.image %}
                <img src="{{ product.image.url }}"
                     alt="{{ product.name }}"
                     class="w-full h-auto">
            {% else %}
                <img src="https://via.placeholder.com/400x300?text=No+Image"
                     alt="No Image"
                     class="w-full h-auto">
            {% endif %}
        </div>
        <div class="md:w-1/2 p-4">
            <h2 class="text-2xl font-semibold mb-2">{{ product.name }}</h2>
            <p class="font-bold mb-4">
                <a href="{{ product.category.get_absolute_url }}">{{ product.category.name }}</a>
            </p>
            <p class="text-gray-700 mb-4">{{ product.description|linebreaks }}</p>

            {% if product.stock > 0 %}
                <div class="p-4 rounded-md outline-2 outline-solid outline-indigo-600">
                    <p class="text-lg font-bold mb-4">{{ product.price }} Rub</p>
                    <p class="text-lg font-bold mb-4">In Stock: {{ product.stock }}</p>

                    <form action="{% url "cart:cart_add" product.id %}" method="post" class="flex flex-row">
                        {{ cart_product_form.quantity | add_class:"flex-none bg-transparent placeholder:text-slate-400 text-slate-700 text-sm border-l border-t border-b border-slate-200 rounded-l-md pl-3 pr-3 py-2 transition duration-300 ease focus:outline-none focus:border-slate-400 hover:border-slate-300 shadow-sm focus:shadow appearance-none [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none" }}

                        {{ cart_product_form.override }}
                        <button type="submit" class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Add to Cart</button>
                        {% csrf_token %} {# Обязательный токен безопасности Django #}

                    </form>
                </div>
            {% else %}
                <span style="color: red;">Out of Stock</span>
            {% endif %}
        </div>
    </div>
{% endblock %}
